<div class="mx-auto ms-lg-80 ps-lg-4">
  <% for (let error of errors) { %>
  <div class="alert alert-danger" role="alert"><%= error.message %></div>
  <% } %> <% if(message.success){ %>
  <div class="alert alert-success" role="alert"><%= message.success %></div>
  <% } %>
  <section>
    <div class="p-8 bg-white navbar-light">
      <div class="row align-items-center justify-content-between">
        <div class="col-12 col-lg-6 mb-4 mb-lg-0">
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb mb-0">
              <li class="breadcrumb-item" aria-current="page">
                <a class="d-flex align-items-center" href="#">
                  <svg
                    class="text-primary me-2"
                    width="20"
                    height="20"
                    viewbox="0 0 20 20"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <path
                      d="M16.8737 16.875V9.02647C16.8737 8.93939 16.8555 8.85327 16.8202 8.77363C16.785 8.694 16.7335 8.6226 16.6691 8.56402L10.4187 2.88159C10.3036 2.77699 10.1537 2.71904 9.99821 2.71904C9.84272 2.71905 9.69281 2.77701 9.57777 2.88162L3.3282 8.56402C3.26377 8.6226 3.2123 8.69399 3.17707 8.77363C3.14185 8.85326 3.12366 8.93937 3.12366 9.02645V16.875"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"></path>
                    <path
                      d="M1.24866 16.875H18.7487"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"></path>
                    <path
                      d="M11.8732 16.8743V12.4993C11.8732 12.3336 11.8073 12.1746 11.6901 12.0574C11.5729 11.9402 11.4139 11.8743 11.2482 11.8743H8.74817C8.58241 11.8743 8.42344 11.9402 8.30623 12.0574C8.18902 12.1746 8.12317 12.3336 8.12317 12.4993V16.8743"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"></path>
                  </svg>
                  <span>Settings</span>
                </a>
              </li>
              <li class="breadcrumb-item active" aria-current="page">
                <a class="d-flex align-items-center" href="#">
                  <svg
                    class="text-primary me-2"
                    width="20"
                    height="20"
                    viewbox="0 0 20 20"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <path
                      d="M17.8125 16.25H2.1875"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"></path>
                    <path
                      d="M7.8125 16.25V6.875H12.1875"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"></path>
                    <path
                      d="M16.5625 3.125H12.1875V16.25H16.5625V3.125Z"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"></path>
                    <path
                      d="M3.4375 16.25V10.625H7.8125"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"></path>
                  </svg>
                  <span>User Management</span>
                </a>
              </li>
            </ol>
          </nav>
        </div>
      </div>
    </div>
  </section>
  <div class="container">
    <div class="container">
      <div class="container">
        <h1 contenteditable="false">Users</h1>

        <!-- Button to trigger modal -->
        <button
          type="button"
          class="btn btn-primary"
          data-bs-toggle="modal"
          data-bs-target="#newUserModal">
          Create New User
        </button>
        <div class="container mt-5">
          <input
            type="text"
            id="searchInput"
            class="form-control mb-3"
            placeholder="Search..." />
          <table class="table table-hover">
            <thead>
              <tr>
                <th data-column="first-name">
                  First Name <span class="sort-icon"></span>
                </th>
                <th data-column="last-name">
                  Last Name <span class="sort-icon"></span>
                </th>
                <th data-column="department">
                  Organisation <span class="sort-icon"></span>
                </th>
                <th data-column="user-role">
                  User Role <span class="sort-icon"></span>
                </th>
                <th data-column="email">
                  Email Address <span class="sort-icon"></span>
                </th>
                <th data-column="phone">
                  Phone Number <span class="sort-icon"></span>
                </th>
                <th data-column="unitsassigned">
                  Units <span class="sort-icon"></span>
                </th>
                <th>Date Joined</th>
              </tr>
            </thead>
            <tbody>
              <% if (users.length > 0) { %> <% for (let user of users) { %>
              <tr>
                <td><%= user.firstname %></td>
                <td><%= user.surname %></td>
                <td><%= user.organisation %></td>
                <td><%= user.user_role %></td>
                <td><%= user.email %></td>
                <td><%= user.phone %></td>
                <td><%= user.unit %></td>
                <td><%= moment(user.date_joined).format('Do MMMM, YYYY') %></td>
                <td>
                  <button class="btn btn-primary edit-user">Edit</button>
                </td>
              </tr>
              <% } %> <% } %>
            </tbody>
          </table>
        </div>
        <!-- Modal -->
        <div
          class="modal fade"
          id="newUserModal"
          tabindex="-1"
          aria-labelledby="newUserModalLabel"
          aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="newUserModalLabel">
                  New User Form
                </h5>
                <button
                  type="button"
                  class="btn-close"
                  data-bs-dismiss="modal"
                  aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <!-- Form -->
                <form action="/add-user" method="post">
                  <div class="mb-3">
                    <label for="firstName" class="form-label">First Name</label>
                    <input
                      type="text"
                      class="form-control"
                      id="firstName"
                      name="firstName"
                      required />
                  </div>
                  <div class="mb-3">
                    <label for="surname" class="form-label">Surname</label>
                    <input
                      type="text"
                      class="form-control"
                      id="surname"
                      name="surname"
                      required />
                  </div>
                  <div class="mb-3">
                    <label for="email" class="form-label">Email Address</label>
                    <input
                      type="email"
                      class="form-control"
                      id="email"
                      name="email"
                      required />
                  </div>
                  <div class="mb-3">
                    <label for="phone" class="form-label">Phone Number</label>
                    <input
                      type="tel"
                      class="form-control"
                      id="phone"
                      name="phone"
                      required />
                  </div>
                  <div class="mb-3">
                    <label for="organisation" class="form-label"
                      >Organisation</label
                    >
                    <select
                      class="form-select"
                      id="organisation"
                      name="organisation"
                      required>
                      <option value="ZNA">ZNA</option>
                      <option value="AFZ">AFZ</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label for="userRole" class="form-label">User Role</label>
                    <select
                      class="form-select"
                      id="userRole"
                      name="userRole"
                      required>
                      <option value="Superuser">Superuser</option>
                      <option value="Admin">Admin</option>
                      <option value="BOO">BOO</option>
                      <option value="Quartermaster">Quartermaster</option>
                      <option value="StoresAssistant">Stores Assistant</option>
                      <option value="StoresClerk">Stores Clerk</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label for="units" class="form-label">Units</label>
                    <select
                      class="form-select"
                      id="units"
                      name="units"
                      multiple="multiple"
                      required>
                      <!-- Add your unit options here -->
                      <option value="unit1">Unit 1</option>
                      <option value="unit2">Unit 2</option>
                      <option value="unit3">Unit 3</option>
                    </select>
                  </div>
                  <button type="submit" class="btn btn-primary">Submit</button>
                </form>
                <!-- End Form -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer container -->
  <div class="main-footer">
    <span>&copy; 2023. Agrifora Management System. All Rights Reserved.</span>
    <span
      >Created by:
      <a href="http://soxfort.com" target="_blank"
        >Soxfort Solutions | Intuitive Innovation</a
      ></span
    >
  </div>
  <!-- main-footer -->
  <!-- Bootstrap JS and Popper.js scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <!-- Select2 JS -->
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

  <script>
    $(document).ready(function () {
      // Initialize Select2 for the "Units" dropdown
      $("#units").select2({
        placeholder: "Select units...",
        tags: true,
        tokenSeparators: [",", " "], // Allow comma or space to create tags
        width: "100%",
      });
    });
  </script>
</div>
