    
        <div class="mx-auto ms-lg-80 ps-lg-4">
          <% for (let error of errors) { %>
            <div class="alert alert-danger" role="alert"><%= error.message %></div>
            <% } %> <% if(message.success){ %>
            <div class="alert alert-success" role="alert"><%= message.success %></div>
            <% } %>
      <section>
        <div class="p-8 bg-white navbar-light">
          <div class="row align-items-center justify-content-between">
            <div class="col-12 col-lg-6 mb-4 mb-lg-0">
              <nav aria-label="breadcrumb">
                <ol class="breadcrumb mb-0">
                  <li class="breadcrumb-item" aria-current="page">
                    <a class="d-flex align-items-center" href="#">
                      <svg class="text-primary me-2" width="20" height="20" viewbox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M16.8737 16.875V9.02647C16.8737 8.93939 16.8555 8.85327 16.8202 8.77363C16.785 8.694 16.7335 8.6226 16.6691 8.56402L10.4187 2.88159C10.3036 2.77699 10.1537 2.71904 9.99821 2.71904C9.84272 2.71905 9.69281 2.77701 9.57777 2.88162L3.3282 8.56402C3.26377 8.6226 3.2123 8.69399 3.17707 8.77363C3.14185 8.85326 3.12366 8.93937 3.12366 9.02645V16.875" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                        <path d="M1.24866 16.875H18.7487" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                        <path d="M11.8732 16.8743V12.4993C11.8732 12.3336 11.8073 12.1746 11.6901 12.0574C11.5729 11.9402 11.4139 11.8743 11.2482 11.8743H8.74817C8.58241 11.8743 8.42344 11.9402 8.30623 12.0574C8.18902 12.1746 8.12317 12.3336 8.12317 12.4993V16.8743" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                      </svg>
                      <span>Inventory Management</span>
                    </a>
                  </li>
                  <li class="breadcrumb-item active" aria-current="page">
                    <a class="d-flex align-items-center" href="#">
                      <svg class="text-primary me-2" width="20" height="20" viewbox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M17.8125 16.25H2.1875" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                        <path d="M7.8125 16.25V6.875H12.1875" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                        <path d="M16.5625 3.125H12.1875V16.25H16.5625V3.125Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                        <path d="M3.4375 16.25V10.625H7.8125" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                      </svg>
                      <span>Products</span>
                    </a>
                  </li>
                </ol>
              </nav>
            </div>
            
          </div>
        </div>
      </section>
      
      <div class="container">
        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addProductModal">
            <i class="fas fa-plus"></i> Add New Product
        </button>
        
        <!-- Export Button -->
        <button type="button" class="btn btn-secondary dropdown-toggle" data-bs-toggle="modal" data-bs-target="#exportModal" aria-expanded="false">
            Export
        </button>
        <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#">Excel</a></li>
            <li><a class="dropdown-item" href="#">PDF</a></li>
        </ul>
       
        <div class="modal fade" id="exportModal" tabindex="-1" aria-labelledby="exportModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exportModalLabel">Export Options</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <p>Select the export format:</p>
                <ul>
                  <li><a class="btn btn-secondary" href="/export-products">Export as Excel</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Search Bar -->
    
        <div class="mt-9">
            <input type="text" class="form-control" id="searchInput" placeholder="Search...">
        </div>
      
     
        
<br></br>
         <table class="table table-striped table-hover">
        <thead class="table-primary">
                <tr>
                    <th scope="col">Product ID</th>
                    <th scope="col">Product Name</th>
                    <th scope="col">Brand/Description</th>
                    <th scope="col">Product Type</th>
                    <th scope="col">Unit Measure</th>
                    <th scope="col">Actions</th>
                </tr>
            </thead>
            <tbody id="productTableBody">
                <!-- Product rows will be added here dynamically -->
                <% if (products) { %>
                  <% for (let dat of products) { %>
                    <tr>
                      <td><%= dat.id %></td>
                      <td><%= dat.product_name %></td>
                      <td><%= dat.description %></td>
                      <td><%= dat.product_type %></td>
                      <td><%= dat.unit %></td>
                      <td>
                        <button type='button' class='btn btn-primary btn-sm viewDispatchBtn' data-bs-toggle='modal' data-bs-target='#viewDispatchModal' ><i class="fa fa-pen"></i></button>
                        <button type='button' class='btn btn-warning btn-sm viewDispatchBtn' data-bs-toggle='modal' data-bs-target='#viewDispatchModal' ><i class="fa fa-trash"></i></button></td>
                  
                    </tr>
                    <% } %>
                    <% } %>
            </tbody>
        </table>
        <!-- Pagination -->
    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-end">
            <li class="page-item disabled">
                <span class="page-link">Previous</span>
            </li>
            <li class="page-item active" aria-current="page">
                <span class="page-link">1 <span class="sr-only">(current)</span></span>
            </li>
            <li class="page-item"><a class="page-link" href="#">2</a></li>
            <li class="page-item"><a class="page-link" href="#">3</a></li>
            <li class="page-item">
                <a class="page-link" href="#">Next</a>
            </li>
        </ul>
    </nav>
</div>

        <div id="alertContainer"></div>
    </div>

    <!-- Add Product Modal -->
    <div class="modal fade" id="addProductModal" tabindex="-1" aria-labelledby="addProductModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
              <form action="/add-product" method="post">
                <div class="modal-header">
                    <h5 class="modal-title" id="addProductModalLabel">Add New Product</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    
                        <div class="mb-3">
                            <label for="productName" class="form-label">Product Name</label>
                            <input type="text" class="form-control" id="productName" name="productName" placeholder="Enter product name" required>
                        </div>
                        <div class="mb-3">
                            <label for="productDescription" class="form-label">Brand/Description</label>
                            <input type="text" class="form-control" id="productDescription" name="productDescription" placeholder="Enter brand/description" required>
                        </div>
                        <div class="mb-3">
                            <label for="productType" class="form-label">Product Type</label>
                            <select class="form-select" id="productType" name="productType" required>
                                <option value="Dry Goods">Dry Goods</option>
                                <option value="Perishable">Perishable</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="unitMeasure" class="form-label">Unit Measure</label>
                            <select class="form-select" id="unitMeasure" name="unitMeasure" required>
                                <option value="Kg">Kgs</option>
                                <option value="Litres">Litres</option>
                                <option value="Bags">Bags</option>
                                <option value="Packs">Packs</option>
                                <option value="Loaves">Loaves</option>
                                <option value="Crates">Crates</option>
                                <option value="Heads">Heads</option>
                                <option value="Cases">Cases</option>
                                <!-- Add other options for unit measures here -->
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="alternateUnit" class="form-label">Alternate Unit</label>
                            <input type="text" class="form-control" id="alternateUnit" name="alternateUnit" placeholder="Enter alternate unit">
                        </div>
                        <div class="mb-3">
                            <label for="conversionFactor" class="form-label">Conversion Factor</label>
                            <input type="number" step="0.01" class="form-control" id="conversionFactor" name="conversionFactor" placeholder="Enter conversion factor">
                        </div>
                    
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary" >Save Product</button>
                </div>
              </form>
            </div>
        </div>
    </div>
  <!-- Footer container -->
  <div class="main-footer">
    <span>&copy; 2023. Agrifora Management System. All Rights Reserved.</span>
    <span>Created by: <a href="http://soxfort.com" target="_blank">Soxfort Solutions | Intuitive Innovation</a></span>
  </div><!-- main-footer -->
    <script src="js/bootstrap/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
   
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const productNameInput = document.getElementById('productName');
            const productDescriptionInput = document.getElementById('productDescription');
            const productTypeInput = document.getElementById('productType');
            const unitMeasureInput = document.getElementById('unitMeasure');
            const alternateUnitInput = document.getElementById('alternateUnit');
            const conversionFactorInput = document.getElementById('conversionFactor');
            const productTableBody = document.getElementById('productTableBody');
            const saveProductButton = document.getElementById('saveProductButton');
            const addProductModal = new bootstrap.Modal(document.getElementById('addProductModal'));
            const alertContainer = document.getElementById('alertContainer');

            let productIdCounter = 1; // Initialize a product ID counter

            // Create an array to store product data, including conversions
            const products = [];

            saveProductButton.addEventListener('click', function () {
                const productName = productNameInput.value;
                const productDescription = productDescriptionInput.value;
                const productType = productTypeInput.value;
                const unitMeasure = unitMeasureInput.value;
                const alternateUnit = alternateUnitInput.value;
                const conversionFactor = parseFloat(conversionFactorInput.value);

          // Create a new product object with both forward and reverse conversions
const product = {
    id: productIdCounter,
    name: productName,
    description: productDescription,
    type: productType,
    units: [
        { name: unitMeasure, conversion: 1 },
        { name: alternateUnit, conversion: conversionFactor },
        // Reverse conversion
        { name: unitMeasure, conversion: 1 / conversionFactor },
        { name: alternateUnit, conversion: 1 }
    ],
    // Add a URL property for the product
    url: 'productmovement.html'
};

                // Add the product to the products array
                products.push(product);

     // Create a new row in the table
const newRow = productTableBody.insertRow();
newRow.innerHTML = `
    <td>${product.id}</td>
    <td><a href="${product.url}" target="_blank">${product.name}</a></td>
    <td>${product.description}</td>
    <td>${product.type}</td>
    <td>
        ${product.units.map(unit => `${unit.conversion} ${unit.name}`).join(' = ')}
    </td>
    <td>
        <button type="button" class="btn btn-success btn-sm" data-bs-toggle="modal" data-bs-target="#editProductModal">
            <i class="fas fa-edit"></i> Edit
        </button>
        <button type="button" class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#deleteProductModal">
            <i class="fas fa-trash-alt"></i> Delete
        </button>
    </td>
`;

                // Increment the product ID counter
                productIdCounter++;

                // Clear the form inputs
                productNameInput.value = '';
                productDescriptionInput.value = '';
                productTypeInput.value = 'dry_goods';
                unitMeasureInput.value = 'Kg';
                alternateUnitInput.value = '';
                conversionFactorInput.value = '';

                // Close the modal
                addProductModal.hide();

                // Display a dismissing alert
                alertContainer.innerHTML = `
                    <div class="alert alert-success alert-dismissible fade show" role="alert">
                        Product added successfully!
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                `;

                // Automatically dismiss the alert after 1 second
                setTimeout(function () {
                    alertContainer.innerHTML = '';
                }, 1000);
            });
        });
    </script>
